define(["require","./Base","../tool/util","../tool/area","../shape/Ring","../shape/Droplet","../shape/Circle"],function(require){function Whirling(options){Base.call(this,options)}var Base=require("./Base"),util=require("../tool/util"),zrArea=require("../tool/area"),RingShape=require("../shape/Ring"),DropletShape=require("../shape/Droplet"),CircleShape=require("../shape/Circle");util.inherits(Whirling,Base);Whirling.prototype._start=function(addShapeHandle,refreshHandle){var options=util.merge(this.options,{textStyle:{color:"#888",textAlign:"start"},backgroundColor:"rgba(250, 250, 250, 0.8)"}),textShape=this.createTextShape(options.textStyle),textGap=10,textWidth=zrArea.getTextWidth(textShape.highlightStyle.text,textShape.highlightStyle.textFont),textHeight=zrArea.getTextHeight(textShape.highlightStyle.text,textShape.highlightStyle.textFont),effectOption=util.merge(this.options.effect||{},{r:18,colorIn:"#fff",colorOut:"#555",colorWhirl:"#6cf",timeInterval:50}),location=this.getLocation(this.options.textStyle,textWidth+textGap+2*effectOption.r,Math.max(2*effectOption.r,textHeight));effectOption.x=location.x+effectOption.r;effectOption.y=textShape.highlightStyle.y=location.y+location.height/2;textShape.highlightStyle.x=effectOption.x+effectOption.r+textGap;var background=this.createBackgroundShape(options.backgroundColor),droplet=new DropletShape({highlightStyle:{a:Math.round(effectOption.r/2),b:Math.round(effectOption.r-effectOption.r/6),brushType:"fill",color:effectOption.colorWhirl}}),circleIn=new CircleShape({highlightStyle:{r:Math.round(effectOption.r/6),brushType:"fill",color:effectOption.colorIn}}),circleOut=new RingShape({highlightStyle:{r0:Math.round(effectOption.r-effectOption.r/3),r:effectOption.r,brushType:"fill",color:effectOption.colorOut}}),pos=[0,effectOption.x,effectOption.y];droplet.highlightStyle.x=circleIn.highlightStyle.x=circleOut.highlightStyle.x=pos[1];droplet.highlightStyle.y=circleIn.highlightStyle.y=circleOut.highlightStyle.y=pos[2];return setInterval(function(){addShapeHandle(background);addShapeHandle(circleOut);pos[0]-=.3;droplet.rotation=pos;addShapeHandle(droplet);addShapeHandle(circleIn);addShapeHandle(textShape);refreshHandle()},effectOption.timeInterval)};return Whirling});