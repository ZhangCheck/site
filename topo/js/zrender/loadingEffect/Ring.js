define(["require","./Base","../tool/util","../tool/color","../shape/Ring","../shape/Sector"],function(require){function Ring(options){Base.call(this,options)}var Base=require("./Base"),util=require("../tool/util"),zrColor=require("../tool/color"),RingShape=require("../shape/Ring"),SectorShape=require("../shape/Sector");util.inherits(Ring,Base);Ring.prototype._start=function(addShapeHandle,refreshHandle){var options=util.merge(this.options,{textStyle:{color:"#07a"},backgroundColor:"rgba(250, 250, 250, 0.8)",effect:{x:this.canvasWidth/2,y:this.canvasHeight/2,r0:60,r:100,color:"#bbdcff",brushType:"fill",textPosition:"inside",textFont:"normal 30px verdana",textColor:"rgba(30, 144, 255, 0.6)",timeInterval:100}}),effectOption=options.effect,textStyle=options.textStyle;null==textStyle.x&&(textStyle.x=effectOption.x);null==textStyle.y&&(textStyle.y=effectOption.y+(effectOption.r0+effectOption.r)/2-5);for(var textShape=this.createTextShape(options.textStyle),background=this.createBackgroundShape(options.backgroundColor),x=effectOption.x,y=effectOption.y,r0=effectOption.r0+6,r=effectOption.r-6,color=effectOption.color,darkColor=zrColor.lift(color,.1),shapeRing=new RingShape({highlightStyle:util.clone(effectOption)}),shapeList=[],clolrList=zrColor.getGradientColors(["#ff6400","#ffe100","#97ff00"],25),preAngle=15,endAngle=240,i=0;16>i;i++){shapeList.push(new SectorShape({highlightStyle:{x:x,y:y,r0:r0,r:r,startAngle:endAngle-preAngle,endAngle:endAngle,brushType:"fill",color:darkColor},_color:zrColor.getLinearGradient(x+r0*Math.cos(endAngle,!0),y-r0*Math.sin(endAngle,!0),x+r0*Math.cos(endAngle-preAngle,!0),y-r0*Math.sin(endAngle-preAngle,!0),[[0,clolrList[2*i]],[1,clolrList[2*i+1]]])}));endAngle-=preAngle}endAngle=360;for(var i=0;4>i;i++){shapeList.push(new SectorShape({highlightStyle:{x:x,y:y,r0:r0,r:r,startAngle:endAngle-preAngle,endAngle:endAngle,brushType:"fill",color:darkColor},_color:zrColor.getLinearGradient(x+r0*Math.cos(endAngle,!0),y-r0*Math.sin(endAngle,!0),x+r0*Math.cos(endAngle-preAngle,!0),y-r0*Math.sin(endAngle-preAngle,!0),[[0,clolrList[2*i+32]],[1,clolrList[2*i+33]]])}));endAngle-=preAngle}var n=0;if(null==options.progress)return setInterval(function(){addShapeHandle(background);n+=n>=20?-20:1;addShapeHandle(shapeRing);for(var i=0;20>i;i++){shapeList[i].highlightStyle.color=n>i?shapeList[i]._color:darkColor;addShapeHandle(shapeList[i])}addShapeHandle(textShape);refreshHandle()},effectOption.timeInterval);addShapeHandle(background);n=100*this.adjust(options.progress,[0,1]).toFixed(2)/5;shapeRing.highlightStyle.text=5*n+"%";addShapeHandle(shapeRing);for(var i=0;20>i;i++){shapeList[i].highlightStyle.color=n>i?shapeList[i]._color:darkColor;addShapeHandle(shapeList[i])}addShapeHandle(textShape);refreshHandle()};return Ring});