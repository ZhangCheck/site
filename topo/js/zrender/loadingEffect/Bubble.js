define(["require","./Base","../tool/util","../tool/color","../shape/Circle"],function(require){function Bubble(options){Base.call(this,options)}var Base=require("./Base"),util=require("../tool/util"),zrColor=require("../tool/color"),CircleShape=require("../shape/Circle");util.inherits(Bubble,Base);Bubble.prototype._start=function(addShapeHandle,refreshHandle){for(var options=util.merge(this.options,{textStyle:{color:"#888"},backgroundColor:"rgba(250, 250, 250, 0.8)",effect:{n:50,lineWidth:2,brushType:"stroke",color:"random",timeInterval:100}}),textShape=this.createTextShape(options.textStyle),background=this.createBackgroundShape(options.backgroundColor),effectOption=options.effect,n=effectOption.n,brushType=effectOption.brushType,lineWidth=effectOption.lineWidth,shapeList=[],canvasWidth=this.canvasWidth,canvasHeight=this.canvasHeight,i=0;n>i;i++){var color="random"==effectOption.color?zrColor.alpha(zrColor.random(),.3):effectOption.color;shapeList[i]=new CircleShape({highlightStyle:{x:Math.ceil(Math.random()*canvasWidth),y:Math.ceil(Math.random()*canvasHeight),r:Math.ceil(40*Math.random()),brushType:brushType,color:color,strokeColor:color,lineWidth:lineWidth},animationY:Math.ceil(20*Math.random())})}return setInterval(function(){addShapeHandle(background);for(var i=0;n>i;i++){var style=shapeList[i].highlightStyle;if(style.y-shapeList[i].animationY+style.r<=0){shapeList[i].highlightStyle.y=canvasHeight+style.r;shapeList[i].highlightStyle.x=Math.ceil(Math.random()*canvasWidth)}shapeList[i].highlightStyle.y-=shapeList[i].animationY;addShapeHandle(shapeList[i])}addShapeHandle(textShape);refreshHandle()},effectOption.timeInterval)};return Bubble});