define(["require","../../tool/vector"],function(require){var vector=require("../../tool/vector"),PathSegment=function(command,points){this.command=command;this.points=points||null},PathProxy=function(){this.pathCommands=[];this._ctx=null;this._min=[];this._max=[]};PathProxy.prototype.fastBoundingRect=function(){var min=this._min,max=this._max;min[0]=min[1]=1/0;max[0]=max[1]=-(1/0);for(var i=0;i<this.pathCommands.length;i++){var seg=this.pathCommands[i],p=seg.points;switch(seg.command){case"M":vector.min(min,min,p);vector.max(max,max,p);break;case"L":vector.min(min,min,p);vector.max(max,max,p);break;case"C":for(var j=0;6>j;j+=2){min[0]=Math.min(min[0],min[0],p[j]);min[1]=Math.min(min[1],min[1],p[j+1]);max[0]=Math.max(max[0],max[0],p[j]);max[1]=Math.max(max[1],max[1],p[j+1])}break;case"Q":for(var j=0;4>j;j+=2){min[0]=Math.min(min[0],min[0],p[j]);min[1]=Math.min(min[1],min[1],p[j+1]);max[0]=Math.max(max[0],max[0],p[j]);max[1]=Math.max(max[1],max[1],p[j+1])}break;case"A":var cx=p[0],cy=p[1],rx=p[2],ry=p[3];min[0]=Math.min(min[0],min[0],cx-rx);min[1]=Math.min(min[1],min[1],cy-ry);max[0]=Math.max(max[0],max[0],cx+rx);max[1]=Math.max(max[1],max[1],cy+ry)}}return{x:min[0],y:min[1],width:max[0]-min[0],height:max[1]-min[1]}};PathProxy.prototype.begin=function(ctx){this._ctx=ctx||null;this.pathCommands.length=0;return this};PathProxy.prototype.moveTo=function(x,y){this.pathCommands.push(new PathSegment("M",[x,y]));this._ctx&&this._ctx.moveTo(x,y);return this};PathProxy.prototype.lineTo=function(x,y){this.pathCommands.push(new PathSegment("L",[x,y]));this._ctx&&this._ctx.lineTo(x,y);return this};PathProxy.prototype.bezierCurveTo=function(x1,y1,x2,y2,x3,y3){this.pathCommands.push(new PathSegment("C",[x1,y1,x2,y2,x3,y3]));this._ctx&&this._ctx.bezierCurveTo(x1,y1,x2,y2,x3,y3);return this};PathProxy.prototype.quadraticCurveTo=function(x1,y1,x2,y2){this.pathCommands.push(new PathSegment("Q",[x1,y1,x2,y2]));this._ctx&&this._ctx.quadraticCurveTo(x1,y1,x2,y2);return this};PathProxy.prototype.arc=function(cx,cy,r,startAngle,endAngle,anticlockwise){this.pathCommands.push(new PathSegment("A",[cx,cy,r,r,startAngle,endAngle-startAngle,0,anticlockwise?0:1]));this._ctx&&this._ctx.arc(cx,cy,r,startAngle,endAngle,anticlockwise);return this};PathProxy.prototype.arcTo=function(x1,y1,x2,y2,radius){this._ctx&&this._ctx.arcTo(x1,y1,x2,y2,radius);return this};PathProxy.prototype.rect=function(x,y,w,h){this._ctx&&this._ctx.rect(x,y,w,h);return this};PathProxy.prototype.closePath=function(){this.pathCommands.push(new PathSegment("z"));this._ctx&&this._ctx.closePath();return this};PathProxy.prototype.isEmpty=function(){return 0===this.pathCommands.length};PathProxy.PathSegment=PathSegment;return PathProxy});