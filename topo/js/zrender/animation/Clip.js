define(["require","./easing"],function(require){function Clip(options){this._targetPool=options.target||{};this._targetPool instanceof Array||(this._targetPool=[this._targetPool]);this._life=options.life||1e3;this._delay=options.delay||0;this._startTime=(new Date).getTime()+this._delay;this._endTime=this._startTime+1e3*this._life;this.loop="undefined"==typeof options.loop?!1:options.loop;this.gap=options.gap||0;this.easing=options.easing||"Linear";this.onframe=options.onframe;this.ondestroy=options.ondestroy;this.onrestart=options.onrestart}var Easing=require("./easing");Clip.prototype={step:function(time){var percent=(time-this._startTime)/this._life;if(!(0>percent)){percent=Math.min(percent,1);var easingFunc="string"==typeof this.easing?Easing[this.easing]:this.easing,schedule="function"==typeof easingFunc?easingFunc(percent):percent;this.fire("frame",schedule);if(1==percent){if(this.loop){this.restart();return"restart"}this.__needsRemove=!0;return"destroy"}return null}},restart:function(){var time=(new Date).getTime(),remainder=(time-this._startTime)%this._life;this._startTime=(new Date).getTime()-remainder+this.gap;this.__needsRemove=!1},fire:function(eventType,arg){for(var i=0,len=this._targetPool.length;len>i;i++)this["on"+eventType]&&this["on"+eventType](this._targetPool[i],arg)},constructor:Clip};return Clip});