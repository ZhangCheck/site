define(["require","./base","zrender/shape/Line","../config","../util/ecData","zrender/tool/util","zrender/tool/color","./categoryAxis","./valueAxis","../component"],function(require){function Axis(ecTheme,messageCenter,zr,option,myChart,axisType){Base.call(this,ecTheme,messageCenter,zr,option,myChart);this.axisType=axisType;this._axisList=[];this.refresh(option)}var Base=require("./base"),LineShape=require("zrender/shape/Line"),ecConfig=require("../config"),ecData=require("../util/ecData"),zrUtil=require("zrender/tool/util"),zrColor=require("zrender/tool/color");Axis.prototype={type:ecConfig.COMPONENT_TYPE_AXIS,axisBase:{_buildAxisLine:function(){var lineWidth=this.option.axisLine.lineStyle.width,halfLineWidth=lineWidth/2,axShape={_axisShape:"axisLine",zlevel:this.getZlevelBase(),z:this.getZBase()+3,hoverable:!1},grid=this.grid;switch(this.option.position){case"left":axShape.style={xStart:grid.getX()-halfLineWidth,yStart:grid.getYend(),xEnd:grid.getX()-halfLineWidth,yEnd:grid.getY(),lineCap:"round"};break;case"right":axShape.style={xStart:grid.getXend()+halfLineWidth,yStart:grid.getYend(),xEnd:grid.getXend()+halfLineWidth,yEnd:grid.getY(),lineCap:"round"};break;case"bottom":axShape.style={xStart:grid.getX(),yStart:grid.getYend()+halfLineWidth,xEnd:grid.getXend(),yEnd:grid.getYend()+halfLineWidth,lineCap:"round"};break;case"top":axShape.style={xStart:grid.getX(),yStart:grid.getY()-halfLineWidth,xEnd:grid.getXend(),yEnd:grid.getY()-halfLineWidth,lineCap:"round"}}var style=axShape.style;if(""!==this.option.name){style.text=this.option.name;style.textPosition=this.option.nameLocation;style.textFont=this.getFont(this.option.nameTextStyle);this.option.nameTextStyle.align&&(style.textAlign=this.option.nameTextStyle.align);this.option.nameTextStyle.baseline&&(style.textBaseline=this.option.nameTextStyle.baseline);this.option.nameTextStyle.color&&(style.textColor=this.option.nameTextStyle.color)}style.strokeColor=this.option.axisLine.lineStyle.color;style.lineWidth=lineWidth;this.isHorizontal()?style.yStart=style.yEnd=this.subPixelOptimize(style.yEnd,lineWidth):style.xStart=style.xEnd=this.subPixelOptimize(style.xEnd,lineWidth);style.lineType=this.option.axisLine.lineStyle.type;axShape=new LineShape(axShape);this.shapeList.push(axShape)},_axisLabelClickable:function(clickable,axShape){if(clickable){ecData.pack(axShape,void 0,-1,void 0,-1,axShape.style.text);axShape.hoverable=!0;axShape.clickable=!0;axShape.highlightStyle={color:zrColor.lift(axShape.style.color,1),brushType:"fill"};return axShape}return axShape},refixAxisShape:function(zeroX,zeroY){if(this.option.axisLine.onZero){var tickLength;if(this.isHorizontal()&&null!=zeroY)for(var i=0,l=this.shapeList.length;l>i;i++)if("axisLine"===this.shapeList[i]._axisShape){this.shapeList[i].style.yStart=this.shapeList[i].style.yEnd=this.subPixelOptimize(zeroY,this.shapeList[i].stylelineWidth);this.zr.modShape(this.shapeList[i].id)}else if("axisTick"===this.shapeList[i]._axisShape){tickLength=this.shapeList[i].style.yEnd-this.shapeList[i].style.yStart;this.shapeList[i].style.yStart=zeroY-tickLength;this.shapeList[i].style.yEnd=zeroY;this.zr.modShape(this.shapeList[i].id)}if(!this.isHorizontal()&&null!=zeroX)for(var i=0,l=this.shapeList.length;l>i;i++)if("axisLine"===this.shapeList[i]._axisShape){this.shapeList[i].style.xStart=this.shapeList[i].style.xEnd=this.subPixelOptimize(zeroX,this.shapeList[i].stylelineWidth);this.zr.modShape(this.shapeList[i].id)}else if("axisTick"===this.shapeList[i]._axisShape){tickLength=this.shapeList[i].style.xEnd-this.shapeList[i].style.xStart;this.shapeList[i].style.xStart=zeroX;this.shapeList[i].style.xEnd=zeroX+tickLength;this.zr.modShape(this.shapeList[i].id)}}},getPosition:function(){return this.option.position},isHorizontal:function(){return"bottom"===this.option.position||"top"===this.option.position}},reformOption:function(opt){!opt||opt instanceof Array&&0===opt.length?opt=[{type:ecConfig.COMPONENT_TYPE_AXIS_VALUE}]:opt instanceof Array||(opt=[opt]);opt.length>2&&(opt=[opt[0],opt[1]]);if("xAxis"===this.axisType){(!opt[0].position||"bottom"!=opt[0].position&&"top"!=opt[0].position)&&(opt[0].position="bottom");opt.length>1&&(opt[1].position="bottom"===opt[0].position?"top":"bottom");for(var i=0,l=opt.length;l>i;i++){opt[i].type=opt[i].type||"category";opt[i].xAxisIndex=i;opt[i].yAxisIndex=-1}}else{(!opt[0].position||"left"!=opt[0].position&&"right"!=opt[0].position)&&(opt[0].position="left");opt.length>1&&(opt[1].position="left"===opt[0].position?"right":"left");for(var i=0,l=opt.length;l>i;i++){opt[i].type=opt[i].type||"value";opt[i].xAxisIndex=-1;opt[i].yAxisIndex=i}}return opt},refresh:function(newOption){var axisOption;if(newOption){this.option=newOption;if("xAxis"===this.axisType){this.option.xAxis=this.reformOption(newOption.xAxis);axisOption=this.option.xAxis}else{this.option.yAxis=this.reformOption(newOption.yAxis);axisOption=this.option.yAxis}this.series=newOption.series}for(var CategoryAxis=require("./categoryAxis"),ValueAxis=require("./valueAxis"),len=Math.max(axisOption&&axisOption.length||0,this._axisList.length),i=0;len>i;i++){if(this._axisList[i]&&newOption&&(!axisOption[i]||this._axisList[i].type!=axisOption[i].type)){this._axisList[i].dispose&&this._axisList[i].dispose();this._axisList[i]=!1}this._axisList[i]?this._axisList[i].refresh&&this._axisList[i].refresh(axisOption?axisOption[i]:!1,this.series):axisOption&&axisOption[i]&&(this._axisList[i]="category"===axisOption[i].type?new CategoryAxis(this.ecTheme,this.messageCenter,this.zr,axisOption[i],this.myChart,this.axisBase):new ValueAxis(this.ecTheme,this.messageCenter,this.zr,axisOption[i],this.myChart,this.axisBase,this.series))}},getAxis:function(idx){return this._axisList[idx]},getAxisCount:function(){return this._axisList.length},clear:function(){for(var i=0,l=this._axisList.length;l>i;i++)this._axisList[i].dispose&&this._axisList[i].dispose();this._axisList=[]}};zrUtil.inherits(Axis,Base);require("../component").define("axis",Axis);return Axis});