define(["require","../config","../util/ecData","../util/ecQuery","../util/number","zrender/tool/util","zrender/tool/env"],function(require){function Base(ecTheme,messageCenter,zr,option,myChart){this.ecTheme=ecTheme;this.messageCenter=messageCenter;this.zr=zr;this.option=option;this.series=option.series;this.myChart=myChart;this.component=myChart.component;this.shapeList=[];this.effectList=[];var self=this;self._onlegendhoverlink=function(param){if(self.legendHoverLink)for(var name,targetName=param.target,i=self.shapeList.length-1;i>=0;i--){name=self.type==ecConfig.CHART_TYPE_PIE||self.type==ecConfig.CHART_TYPE_FUNNEL?ecData.get(self.shapeList[i],"name"):(ecData.get(self.shapeList[i],"series")||{}).name;name!=targetName||self.shapeList[i].invisible||self.shapeList[i].__animating||self.zr.addHoverShape(self.shapeList[i])}};messageCenter&&messageCenter.bind(ecConfig.EVENT.LEGEND_HOVERLINK,this._onlegendhoverlink)}var ecConfig=require("../config"),ecData=require("../util/ecData"),ecQuery=require("../util/ecQuery"),number=require("../util/number"),zrUtil=require("zrender/tool/util");Base.prototype={canvasSupported:require("zrender/tool/env").canvasSupported,_getZ:function(zWhat){if(null!=this[zWhat])return this[zWhat];var opt=this.ecTheme[this.type];if(opt&&null!=opt[zWhat])return opt[zWhat];opt=ecConfig[this.type];return opt&&null!=opt[zWhat]?opt[zWhat]:0},getZlevelBase:function(){return this._getZ("zlevel")},getZBase:function(){return this._getZ("z")},reformOption:function(opt){opt=zrUtil.merge(zrUtil.merge(opt||{},zrUtil.clone(this.ecTheme[this.type]||{})),zrUtil.clone(ecConfig[this.type]||{}));this.z=opt.z;this.zlevel=opt.zlevel;return opt},reformCssArray:function(p){if(!(p instanceof Array))return[p,p,p,p];switch(p.length+""){case"4":return p;case"3":return[p[0],p[1],p[2],p[1]];case"2":return[p[0],p[1],p[0],p[1]];case"1":return[p[0],p[0],p[0],p[0]];case"0":return[0,0,0,0]}},getShapeById:function(id){for(var i=0,l=this.shapeList.length;l>i;i++)if(this.shapeList[i].id===id)return this.shapeList[i];return null},getFont:function(textStyle){var finalTextStyle=this.getTextStyle(zrUtil.clone(textStyle));return finalTextStyle.fontStyle+" "+finalTextStyle.fontWeight+" "+finalTextStyle.fontSize+"px "+finalTextStyle.fontFamily},getTextStyle:function(targetStyle){return zrUtil.merge(zrUtil.merge(targetStyle||{},this.ecTheme.textStyle),ecConfig.textStyle)},getItemStyleColor:function(itemColor,seriesIndex,dataIndex,data){return"function"==typeof itemColor?itemColor.call(this.myChart,{seriesIndex:seriesIndex,series:this.series[seriesIndex],dataIndex:dataIndex,data:data}):itemColor},getDataFromOption:function(data,defaultData){return null!=data?null!=data.value?data.value:data:defaultData},subPixelOptimize:function(position,lineWidth){position=lineWidth%2===1?Math.floor(position)+.5:Math.round(position);return position},resize:function(){this.refresh&&this.refresh();this.clearEffectShape&&this.clearEffectShape(!0);var self=this;setTimeout(function(){self.animationEffect&&self.animationEffect()},200)},clear:function(){this.clearEffectShape&&this.clearEffectShape();this.zr&&this.zr.delShape(this.shapeList);this.shapeList=[]},dispose:function(){this.onbeforDispose&&this.onbeforDispose();this.clear();this.shapeList=null;this.effectList=null;this.messageCenter&&this.messageCenter.unbind(ecConfig.EVENT.LEGEND_HOVERLINK,this._onlegendhoverlink);this.onafterDispose&&this.onafterDispose()},query:ecQuery.query,deepQuery:ecQuery.deepQuery,deepMerge:ecQuery.deepMerge,parsePercent:number.parsePercent,parseCenter:number.parseCenter,parseRadius:number.parseRadius,numAddCommas:number.addCommas,getPrecision:number.getPrecision};return Base});