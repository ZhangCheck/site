define(["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../config","zrender/tool/util","zrender/tool/area","zrender/tool/color","../component"],function(require){function Title(ecTheme,messageCenter,zr,option,myChart){Base.call(this,ecTheme,messageCenter,zr,option,myChart);this.refresh(option)}var Base=require("./base"),TextShape=require("zrender/shape/Text"),RectangleShape=require("zrender/shape/Rectangle"),ecConfig=require("../config");ecConfig.title={zlevel:0,z:6,show:!0,text:"",subtext:"",x:"left",y:"top",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:5,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}};var zrUtil=require("zrender/tool/util"),zrArea=require("zrender/tool/area"),zrColor=require("zrender/tool/color");Title.prototype={type:ecConfig.COMPONENT_TYPE_TITLE,_buildShape:function(){if(this.titleOption.show){this._itemGroupLocation=this._getItemGroupLocation();this._buildBackground();this._buildItem();for(var i=0,l=this.shapeList.length;l>i;i++)this.zr.addShape(this.shapeList[i])}},_buildItem:function(){var text=this.titleOption.text,link=this.titleOption.link,target=this.titleOption.target,subtext=this.titleOption.subtext,sublink=this.titleOption.sublink,subtarget=this.titleOption.subtarget,font=this.getFont(this.titleOption.textStyle),subfont=this.getFont(this.titleOption.subtextStyle),x=this._itemGroupLocation.x,y=this._itemGroupLocation.y,width=this._itemGroupLocation.width,height=this._itemGroupLocation.height,textShape={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{y:y,color:this.titleOption.textStyle.color,text:text,textFont:font,textBaseline:"top"},highlightStyle:{color:zrColor.lift(this.titleOption.textStyle.color,1),brushType:"fill"},hoverable:!1};if(link){textShape.hoverable=!0;textShape.clickable=!0;textShape.onclick=function(){target&&"self"==target?window.location=link:window.open(link)}}var subtextShape={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{y:y+height,color:this.titleOption.subtextStyle.color,text:subtext,textFont:subfont,textBaseline:"bottom"},highlightStyle:{color:zrColor.lift(this.titleOption.subtextStyle.color,1),brushType:"fill"},hoverable:!1};if(sublink){subtextShape.hoverable=!0;subtextShape.clickable=!0;subtextShape.onclick=function(){subtarget&&"self"==subtarget?window.location=sublink:window.open(sublink)}}switch(this.titleOption.x){case"center":textShape.style.x=subtextShape.style.x=x+width/2;textShape.style.textAlign=subtextShape.style.textAlign="center";break;case"left":textShape.style.x=subtextShape.style.x=x;textShape.style.textAlign=subtextShape.style.textAlign="left";break;case"right":textShape.style.x=subtextShape.style.x=x+width;textShape.style.textAlign=subtextShape.style.textAlign="right";break;default:x=this.titleOption.x-0;x=isNaN(x)?0:x;textShape.style.x=subtextShape.style.x=x}this.titleOption.textAlign&&(textShape.style.textAlign=subtextShape.style.textAlign=this.titleOption.textAlign);this.shapeList.push(new TextShape(textShape));""!==subtext&&this.shapeList.push(new TextShape(subtextShape))},_buildBackground:function(){var padding=this.reformCssArray(this.titleOption.padding);this.shapeList.push(new RectangleShape({zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this._itemGroupLocation.x-padding[3],y:this._itemGroupLocation.y-padding[0],width:this._itemGroupLocation.width+padding[3]+padding[1],height:this._itemGroupLocation.height+padding[0]+padding[2],brushType:0===this.titleOption.borderWidth?"fill":"both",color:this.titleOption.backgroundColor,strokeColor:this.titleOption.borderColor,lineWidth:this.titleOption.borderWidth}}))},_getItemGroupLocation:function(){var x,padding=this.reformCssArray(this.titleOption.padding),text=this.titleOption.text,subtext=this.titleOption.subtext,font=this.getFont(this.titleOption.textStyle),subfont=this.getFont(this.titleOption.subtextStyle),totalWidth=Math.max(zrArea.getTextWidth(text,font),zrArea.getTextWidth(subtext,subfont)),totalHeight=zrArea.getTextHeight(text,font)+(""===subtext?0:this.titleOption.itemGap+zrArea.getTextHeight(subtext,subfont)),zrWidth=this.zr.getWidth();switch(this.titleOption.x){case"center":x=Math.floor((zrWidth-totalWidth)/2);break;case"left":x=padding[3]+this.titleOption.borderWidth;break;case"right":x=zrWidth-totalWidth-padding[1]-this.titleOption.borderWidth;break;default:x=this.titleOption.x-0;x=isNaN(x)?0:x}var y,zrHeight=this.zr.getHeight();switch(this.titleOption.y){case"top":y=padding[0]+this.titleOption.borderWidth;break;case"bottom":y=zrHeight-totalHeight-padding[2]-this.titleOption.borderWidth;break;case"center":y=Math.floor((zrHeight-totalHeight)/2);break;default:y=this.titleOption.y-0;y=isNaN(y)?0:y}return{x:x,y:y,width:totalWidth,height:totalHeight}},refresh:function(newOption){if(newOption){this.option=newOption;this.option.title=this.reformOption(this.option.title);this.titleOption=this.option.title;this.titleOption.textStyle=this.getTextStyle(this.titleOption.textStyle);this.titleOption.subtextStyle=this.getTextStyle(this.titleOption.subtextStyle)}this.clear();this._buildShape()}};zrUtil.inherits(Title,Base);require("../component").define("title",Title);return Title});