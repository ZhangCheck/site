define([],function(){function getAutoFormatter(min,max,splitNumber){splitNumber=splitNumber>1?splitNumber:2;for(var curValue,totalGap,formatter,gapValue,i=0,l=_timeGap.length;l>i;i++){curValue=_timeGap[i].value;totalGap=Math.ceil(max/curValue)*curValue-Math.floor(min/curValue)*curValue;if(Math.round(totalGap/curValue)<=1.2*splitNumber){formatter=_timeGap[i].formatter;gapValue=_timeGap[i].value;break}}if(null==formatter){formatter="year";curValue=317088e5;totalGap=Math.ceil(max/curValue)*curValue-Math.floor(min/curValue)*curValue;gapValue=Math.round(totalGap/(splitNumber-1)/curValue)*curValue}return{formatter:formatter,gapValue:gapValue}}function s2d(v){return 10>v?"0"+v:v}function format(formatter,value){("week"==formatter||"month"==formatter||"quarter"==formatter||"half-year"==formatter||"year"==formatter)&&(formatter="MM - dd\nyyyy");var date=getNewDate(value),y=date.getFullYear(),M=date.getMonth()+1,d=date.getDate(),h=date.getHours(),m=date.getMinutes(),s=date.getSeconds();formatter=formatter.replace("MM",s2d(M));formatter=formatter.toLowerCase();formatter=formatter.replace("yyyy",y);formatter=formatter.replace("yy",y%100);formatter=formatter.replace("dd",s2d(d));formatter=formatter.replace("d",d);formatter=formatter.replace("hh",s2d(h));formatter=formatter.replace("h",h);formatter=formatter.replace("mm",s2d(m));formatter=formatter.replace("m",m);formatter=formatter.replace("ss",s2d(s));formatter=formatter.replace("s",s);return formatter}function nextMonday(value){value=getNewDate(value);value.setDate(value.getDate()+8-value.getDay());return value}function nextNthPerNmonth(value,nth,nmon){value=getNewDate(value);value.setMonth(Math.ceil((value.getMonth()+1)/nmon)*nmon);value.setDate(nth);return value}function nextNthOnMonth(value,nth){return nextNthPerNmonth(value,nth,1)}function nextNthOnQuarterYear(value,nth){return nextNthPerNmonth(value,nth,3)}function nextNthOnHalfYear(value,nth){return nextNthPerNmonth(value,nth,6)}function nextNthOnYear(value,nth){return nextNthPerNmonth(value,nth,12)}function getNewDate(value){return value instanceof Date?value:new Date("string"==typeof value?value.replace(/-/g,"/"):value)}var _timeGap=[{formatter:"hh : mm : ss",value:1e3},{formatter:"hh : mm : ss",value:5e3},{formatter:"hh : mm : ss",value:1e4},{formatter:"hh : mm : ss",value:15e3},{formatter:"hh : mm : ss",value:3e4},{formatter:"hh : mm\nMM - dd",value:6e4},{formatter:"hh : mm\nMM - dd",value:3e5},{formatter:"hh : mm\nMM - dd",value:6e5},{formatter:"hh : mm\nMM - dd",value:9e5},{formatter:"hh : mm\nMM - dd",value:18e5},{formatter:"hh : mm\nMM - dd",value:36e5},{formatter:"hh : mm\nMM - dd",value:72e5},{formatter:"hh : mm\nMM - dd",value:216e5},{formatter:"hh : mm\nMM - dd",value:432e5},{formatter:"MM - dd\nyyyy",value:864e5},{formatter:"week",value:6048e5},{formatter:"month",value:26784e5},{formatter:"quarter",value:8208e6},{formatter:"half-year",value:16416e6},{formatter:"year",value:32832e6}];return{getAutoFormatter:getAutoFormatter,getNewDate:getNewDate,format:format,nextMonday:nextMonday,nextNthPerNmonth:nextNthPerNmonth,nextNthOnMonth:nextNthOnMonth,nextNthOnQuarterYear:nextNthOnQuarterYear,nextNthOnHalfYear:nextNthOnHalfYear,nextNthOnYear:nextNthOnYear}});